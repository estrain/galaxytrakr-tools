<tool id="spades_cpu7mem28" name="SPAdes" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="20.01">
    <description>genome assembler for genomes of regular and single-cell projects</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <xrefs>
        <xref type="bio.tools">spades</xref>
    </xrefs>
    <expand macro="requirements"/>
    <expand macro="stdio"/>
    <expand macro="version_command"/>
    <command detect_errors="exit_code"><![CDATA[

#set $library = 1

@PREPROCESS_INPUT_FILES_MAIN@
#if $additional_reads.selector == 'true'
    @PREPROCESS_INPUT_FILES_ADDITIONAL@
#end if
@PREPROCESS_NANOPORE_PACBIO_FILES@
@PREPROCESS_CONTIGS_FILES@
@PREPROCESS_SANGER_FILES@

@OMP_THREADS@
## run
spades.py
    $operation_mode
    -o 'output'    
    @RESOURCES@
    @INPUT_READS_MAIN@
    #if $additional_reads.selector == 'true'
        @INPUT_READS_ADDITIONAL@
    #end if
    ## additional reads
    @NANOPORE_PACBIO@
    @SANGER@
    @CONTIGS@
    ## parameter
    #if $cov_cond.cov_cutoff == 'value':
        --cov-cutoff $cov_cond.manual
    #else:
        --cov-cutoff $cov_cond.cov_cutoff
    #end if
    @KMER@
    @PIPELINE_OPTIONS@
    @PHREDOFFSET@    

    ## postprocessing
    @STATS@
    ]]></command>
    <inputs>
        <expand macro="operation_mode" help="To run read error correction, reads should be in FASTQ format."/>
        <expand macro="input_files_all" format="@INTYPES@" label="FASTA/FASTQ file(s)"/>
        <expand macro="input_additional_files_all" format="@INTYPES@" label="FASTA/FASTQ file(s)"/>
        <section name="arf" title="Additional read files">
            <expand macro="nanopore_pacbio"/>
            <expand macro="sanger"/>
            <expand macro="contigs"/>
        </section>
        <expand macro="pipeline_options" additional_help="&quot;Isolate&quot; is not compatible with &quot;Careful&quot; and Operation mode &quot;Only error correction&quot;">
            <option value="--sc">Single cell mode: required for MDA (single-cell) data (--sc)</option>
            <option value="--isolate">Isolate: highly recommended for high-coverage isolate and multi-cell data (--isolate)</option>
            <option value="--careful">Careful: ties to reduce the number of mismatches and short indels. Only recommended for small genomes (--careful)</option>
            <option value="--iontorrent">Iontorrent: required when assembling IonTorrent data (--iontorrent)</option>
        </expand>
        <expand macro="covcutoff"/>
        <expand macro="kmer" help="If --sc is set the default values are 21,33,55. For multicell datasets K values are automatically selected using maximum read length."/>        
        <expand macro="phred"/>
        <expand macro="optional_output"/>
    </inputs>
    <outputs>
        <expand macro="out_ag"/>
        <expand macro="out_ags"/>
        <expand macro="out_cn"/>
        <expand macro="out_cp"/>
        <expand macro="out_cr"/>
        <expand macro="out_cs"/>
        <expand macro="out_l"/>
        <expand macro="out_sc"/>
        <expand macro="out_sp"/>
        <expand macro="out_ss"/>        
    </outputs>
    <!-- tests/help/citations unchanged -->
</tool>

